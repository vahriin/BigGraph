# Task2

Программа для построения на графе дорог города кратчайших путей от задаваемой до выбранных точек. Второе задание по Теории Конечных Графов. Версия 1.0

## Легенда:

В качестве конечных точек были выбраны 10 пожарных частей города Уфы.

## Фичи:

* Интерфейс ввода координат реализован посредством xml-файла
* Параллельная реализация вывода
* Реализация алгоритмов Дейкстры, Левита, A*
* Алгоритм A* реализован в параллельном варианте
* Отключение вывода в файлы для тестирования
* Тестирование для пунктов 2 и 3 задания
* Пасхалка-пасхалочка (работает только на карте Уфы)

## Планы:

* Реализация Дейкстры с использованием бинарной кучи

## Системные требования:

* OS: Windows x86/x86_64, Linux x86/x86_64
* x86/x86_64 совместимый процессор
* Примерно 10n Free RAM, где n - размер входных файлов
* Для сборки: версия GO не ниже 1.8
* Для тестирования: GO не ниже 1.8, Python не ниже 3.6, POSIX-совместимая OS.

## Получение: 

#### Готовый билд: 

[Скачайте](https://drive.google.com/drive/folders/1f592j2D2QWnLc9NYC2LKQIhmo9BGqxw6?usp=sharing) готовый билд для Вашей OS. 

#### Сборка из исходников:

1. Установите [GO](https://golang.org/dl/)
1. Установите [$GOPATH](https://github.com/golang/go/wiki/SettingGOPATH)
1. Выполните ```go get github.com/vahriin/BigGraph```
1. Выполните ```go install github.com/vahriin/BigGraph/Task2```
1. В директории ```$GOPATH/bin``` появится бинарный файл ```Task2```, после чего вы можете его запустить из командной строки.

## Использование

Используйте файлы ```adjacency_list.csv``` и ```node_list.csv```, сгенерированные при помощи [Task1](https://github.com/vahriin/BigGraph/tree/master/Task1). Поместите их в директорию ```./input/Task2```. Также в этой директории должны находиться файлы ```destination_points.csv``` и ```point.xml```, представляющие конечные точки и начальную точку соответственно. Примеры файлов вы можете найти [здесь](https://drive.google.com/drive/folders/1etnIJyZGjnMhCC1LwSRabLVASWjRW_Hl?usp=sharing)

Измените аттрибуты ```lat``` и ```lon``` в файле ```point.xml``` в соответствии с широтой и долготой требуемой точки.

Запустите программу из командной строки. Программой будут сгенерированы:

1. Файл ```pathways.csv```. Каждая строка файла - путь от начальной точки до одной из конечных. Пути отсортированы по возрастанию длины.

2. Файл ```road_graph.svg```, в котором на изображение города будут наложены сгенерированные пути. Зеленым кругом обозначена начальная точка. Желтыми - конечные точки, пути до которых не являются кратчайшими; соответствующие пути отрисованы желтым цветом. Красный круг - конечная точка, расстояние до которой минимально; путь до нее отрисован красным цветом.

3. В стандартный вывод будет передана информация о длинах сгенерированных путей и времени достижения каждой точки. (Внимание: данный вывод не будет отключен в тестовом режиме).

## Анализ тестирования

Проводится тестирование алгоритмов на 100 равномерно распределенных по карте точках.

### Анализ времени выполнения

Время выполнения оценивалось путем подсчета суммы времени выполнения программы для каждой точки. Несмотря на то, что данную оценку нельзя считать точной, ввиду того, что в данное время входят в том числе и операции ввода-вывода, будем считать, что данная оценка является достаточной для наших целей. При оценке обеспечивалась стабильно низкая нагрузка на процессор со стороны других программ в течении всего времени выполнения.

1. Алгоритм Дейкстры: время выполнения алгоритма составило 1452 секунды, среднее время выполнения около 14 секунд на точку.

2. Алгоритм Левита: время выполнения алгоритма составило 34.5 секунды, среднее время выполнения около 0.3 секунды на точку.

3. Алгоритм A*:

  1. С метрикой "Евклидово расстояние": время выполнения алгоритма составило 40.3 секунд, среднее время выполнения около 0.4 секунды на точку.

  2. С метрикой "Манхеттоновское расстояние": время выполнения алгоритма составило 40.5 секунд, среднее время выполнения около 0.4 секунды на точку.

  3. С метрикой "Расстояние Чебышева": время выполнения алгоритма составило 45.5 секунд, среднее время выполнения около 0.45 секунды на точку.

**Вывод:** Несмотря на примененные оптимизации (выход из алгоритма осуществляется сразу после достижения последней точки) алгоритм Дейкстры имеет неприемлимо большое время работы. Предполагается, что реализация с использованием бинарной кучи позволит ненамного сократить время выполнения. Алгоритм Левита работает гораздо быстрее алгоритма Дейкстры. Таким образом, использование алгоритма Левита на реальных графах может уменьшить время выполнения. Алгоритм A* работает за время, сравнимое с алгоритмом Левита; незначительно большее время выполнения объясняется необходимостью применять алгоритм для каждой точки назначения отдельно.

### Анализ правильности выполнения

Правильность выполнения оценивалась путем сравнения результатов выполнения алгоритмов на пяти случайных точках. Сравнивались длины кратчайших путей для каждого алгоритма, а так же время подъезда. Считается, что алгоритм Дейкстры и алгоритм Левита выявляют кратчайшие пути, так как это доказано математически. Таким образом, оценивалась правильность выполнения алгоритма A* с различными эвристическими функциями. Сравнение производилось вручную с использованием утилиты командной строки diff. 

1. Метрика "Евклидово расстояние": дистанция и время полностью эквивалентны результату алгоритма Дейкстры, при сравнении путей иногда обнаруживаются незначительные отклонения (замена 1-2 точек путей), вызванных, по видимости, влиянием эвристической функции.

2. Метрика "Манхеттоновское расстояние": дистанция и время подъезда к некоторым точкам отличаются от результата алгоритма Дейкстры в большую сторону. Ошибка составляет от 500 до 6000 метров, в зависимости от удаленности точки назначения. Для трех точек из пяти кратчайшее расстояние эквивалентно результату алгоритма Дейкстры. При сравнении путей выявлены значительные отклонения.

3. Метрика "Расстояние Чебышева": на двух точках выявлено полное совпадение дистанции и времени подъезда с результатами алгоритма Дейкстры. Пути при этом отличаются незначительно. Для оставшихся трех точек ошибка составляет от 20 до 1000 метров в зависимости от удаленности точки назначения. Для всех точек кратчайшее расстояние эквивалентно результату алгоритма Дейкстры. Отклонения путей незначительны, однако выражены сильнее, нежели для метрики "Евклидово расстояние".

**Вывод:** использование метрики "Манхеттоновское расстояние" на реальных графах неоправдано ввиду неудовлетворительных результатов. Оставшиеся метрики могут использоваться в зависимости от приоритетности правильности/быстроты постоения пути.

## Благодарности
* Моим соседям и T-Rex'у от SELECTEL, которым я объяснял, как должен работать код и жаловался, что он не работает.
* Традиционно: группам Black Veil Brides и Lords of Black.
